name: Fetch Playlist Info

on:
  schedule:
    # Runs at 01:00 each Saturday and Sunday
    - cron: '0 1 * * 0,6'
  
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  fetch:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: '16'
          cache: 'npm'
      - run: npm install
      - run: npm run get-playlists
        env: 
          SPOTIFY_CLIENT_ID: ${{ secrets.SPOTIFY_CLIENT_ID }}
          SPOTIFY_CLIENT_SECRET: ${{ secrets.SPOTIFY_CLIENT_SECRET }}
      - name: prepare commit
        run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add _data
      - name: push commit
        run: |
          if [[ $(git status --porcelain) ]]; then
          git commit -m "Add TestTafel Spotify playlist data"
          git push
          fi
